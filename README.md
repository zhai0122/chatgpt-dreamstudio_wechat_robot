<div align="center">
<h1>ChatGPT-DreamStudio WeChat Robot</h1>
<p>  ğŸ¨åŸºäºGOè¯­è¨€å®ç°çš„å¾®ä¿¡èŠå¤©å’Œå›¾ç‰‡ç”Ÿæˆæœºå™¨äººğŸ¨ </p>
<img src="https://camo.githubusercontent.com/82291b0fe831bfc6781e07fc5090cbd0a8b912bb8b8d4fec0696c881834f81ac/68747470733a2f2f70726f626f742e6d656469612f394575424971676170492e676966" width="800"  height="3">
</div><div align="left"></div>
ä¸ªäººå¾®ä¿¡æ¥å…¥ChatGPTï¼Œå®ç°å’ŒGPTæœºå™¨äººäº’åŠ¨èŠå¤©ï¼ŒåŒæ—¶æ”¯æŒåŸºäºæ–‡æœ¬ç”Ÿæˆå›¾åƒã€‚æ”¯æŒç§èŠå›å¤å’Œç¾¤èŠè‰¾ç‰¹å›å¤ã€‚

### å®ç°åŠŸèƒ½

* GPTæœºå™¨äººæ¨¡å‹çƒ­åº¦å¯é…ç½®
* æé—®å¢åŠ ä¸Šä¸‹æ–‡&æŒ‡ä»¤æ¸…ç©ºä¸Šä¸‹æ–‡
* DreamStudioå›¾åƒç”Ÿæˆæ¨¡å‹å‚æ•°å¯é…ç½®
* å¯è®¾å®šå›¾åƒç”Ÿæˆè§¦å‘æŒ‡ä»¤
* æœºå™¨äººç§èŠå›å¤&æœºå™¨äººç¾¤èŠ@å›å¤
* å¥½å‹æ·»åŠ è‡ªåŠ¨é€šè¿‡å¯é…ç½®

### å®ç°æœºåˆ¶
1. åˆ©ç”¨å¾®ä¿¡Aä½œä¸ºæœºå™¨äººæ‰«ç ç™»å½•ç¨‹åºæ¨¡æ‹Ÿçš„å¾®ä¿¡ç”µè„‘ç«¯ï¼Œç¨‹åºåç«¯è°ƒç”¨APIæ¥å£è¿›è¡Œæ–‡æœ¬å›å¤å’Œå›¾ç‰‡ç”Ÿæˆã€‚å…¶ä»–å¾®ä¿¡è´¦å·ä¸å¾®ä¿¡AèŠå¤©å®ç°å¾®ä¿¡ä¸ªäººæœºå™¨äººåŠŸèƒ½ã€‚åŸºäº[openwechat](https://github.com/eatmoreapple/openwechat)å¼€æºä»“åº“å®ç°

2. åŸºäºopenaiå®˜ç½‘æä¾›çš„GPT APIï¼Œå®ç°æ–‡æœ¬äº¤äº’åŠŸèƒ½ï¼Œæ¯ä¸ªæ–°è´¦å·å‰ä¸‰ä¸ªæœˆæœ‰18ç¾å…ƒå…è´¹é¢åº¦ã€‚
3. åŸºäºstabilityå®˜ç½‘æä¾›çš„DreamStudio API,å®ç°å›¾åƒç”ŸæˆåŠŸèƒ½ï¼Œæ¯ä¸ªè´¦å·æ³¨å†Œé€500å¼ å›¾åƒç”Ÿæˆå…è´¹é¢åº¦ï¼Œç©ç©åŸºæœ¬å¤Ÿç”¨äº†ï¼Œä¸å¤Ÿçš„è¯10$å¯è´­ä¹°5000å¼ ã€‚

> GPTçš„[å®˜æ–¹æ–‡æ¡£](https://beta.openai.com/docs/models/overview)å’Œè¯¦ç»†[å‚æ•°ç¤ºä¾‹](https://beta.openai.com/examples) ã€‚
>
> DreamStudioçš„[å®˜æ–¹æ–‡æ¡£](https://platform.stability.ai/docs/getting-started)å’Œè¯¦ç»†[å‚æ•°ç¤ºä¾‹](https://platform.stability.ai/rest-api#tag/v1generation/operation/textToImage) ã€‚

### ä½¿ç”¨å‰æ

* æœ‰openaiè´¦å·ï¼Œå¹¶ä¸”åˆ›å»ºå¥½api_keyï¼Œæ³¨å†Œäº‹é¡¹å¯ä»¥å‚è€ƒ[æ­¤æ–‡ç« ](https://juejin.cn/post/7173447848292253704) ã€‚
* æœ‰dreamstudio.aiè´¦å·ï¼Œå¹¶ä¸”åˆ›å»ºå¥½api_key
* å¾®ä¿¡å¿…é¡»å®åè®¤è¯ã€‚æœ€å¥½ç”¨å°å·

### æ³¨æ„äº‹é¡¹

* é¡¹ç›®ä»…ä¾›å¨±ä¹ï¼Œæ»¥ç”¨å¯èƒ½æœ‰å¾®ä¿¡å°ç¦çš„é£é™©ï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ã€‚
* è¯·æ³¨æ„æ”¶å‘æ•æ„Ÿä¿¡æ¯ï¼Œæœ¬é¡¹ç›®ä¸åšä¿¡æ¯è¿‡æ»¤ã€‚
* dreamstudioå›¾åƒç”Ÿæˆ ä»…å¯¹è‹±æ–‡çš„æ”¯æŒæ¯”è¾ƒå¥½

## ç»“æœå±•ç¤º

<img src="https://blog-1257904201.cos.ap-shanghai.myqcloud.com/imgScreenshot_20230324_181306_edit_70435407551751.jpg.jpg" alt="Screenshot_20230324_181306_edit_70435407551751.jpg" style="zoom:50%;" />

## dockerè¿è¡Œ

ä½¿ç”¨dockerå¿«é€Ÿè¿è¡Œæœ¬é¡¹ç›®ã€‚

#### 1.åŸºäºé…ç½®æ–‡ä»¶æŒ‚è½½è¿è¡Œ(æ¨è)

```sh
# 1. åˆ›å»ºç›®å½•
$ mkdir -p /data/openai
$ cd /data/openai
# 2. åˆ›å»ºé…ç½®æ–‡ä»¶
$ touch config.json
# 3. ç¼–è¾‘é…ç½®æ–‡ä»¶ ...  é…ç½®å†…å®¹ç²˜è´´ä¸‹æ–‡ ã€é…ç½®è¯´æ˜ã€‘å¹¶æŒ‰éœ€ä¿®æ”¹
$ vim config.json
# 4. æ‹‰å–é•œåƒ
$ docker run -dti --name wechatbot -v /data/openai/config.json:/app/config.json  yinqishuo/wechatbot:latest
# 5. è¿›å…¥å®¹å™¨å†…éƒ¨ï¼Œæ‰“å¼€æ—¥å¿—æ–‡ä»¶æ‰«ç ç™»é™†
$ docker exec -it wechatbot bash 
$ tail -f -n 50 /app/run.log 

# æ“ä½œå‡ºé”™ååˆ é™¤å®¹å™¨çš„æ“ä½œ
$ docker stop wechatbot
$ docker remove wechatbot

# é€€å‡ºå®¹å™¨
$ exit
```

å…¶ä¸­é…ç½®æ–‡ä»¶å‚è€ƒä¸‹è¾¹çš„é…ç½®æ–‡ä»¶è¯´æ˜ã€‚ 

#### 2.åŸºäºç¯å¢ƒå˜é‡è¿è¡Œ

```sh
# è¿è¡Œé¡¹ç›®ï¼Œç¯å¢ƒå˜é‡å‚è€ƒä¸‹æ–¹é…ç½®è¯´æ˜
$ docker run -itd --name wechatbot --restart=always \
 -e GPTAPIKEY=æ¢æˆä½ çš„GPT key \
 -e AUTO_PASS=false \
 -e SESSION_TIMEOUT=60s \
 -e MODEL=text-davinci-003 \
 -e MAX_TOKENS=512 \
 -e TEMPREATURE=0.9 \
 -e REPLY_PREFIX=æˆ‘æ˜¯æ¥è‡ªæœºå™¨äººå›å¤: \
 -e SESSION_CLEAR_TOKEN=ä¸‹ä¸ªé—®é¢˜ \
 -e DREAMSTDIO_APIKEY=æ¢æˆä½ çš„dreamstudio key \
 -e ENGINE_ID=stable-diffusion-v1-5 \
 -e PICTURE_WIDTH=512 \
 -e PICTURE_HEIGHT=512 \
 -e STEPS=30 \
 -e CFG_SCALE= 7 \
 -e PICTURE_TOKEN=ç”Ÿæˆå›¾ç‰‡ \
 yinqishuo/wechatbot:latest

#è¿›å…¥å®¹å™¨å†…éƒ¨ï¼Œæ‰“å¼€æ—¥å¿—æ–‡ä»¶æ‰«ç ç™»é™†
$ docker exec -it wechatbot bash 
$ tail -f -n 50 /app/run.log 

# é€€å‡ºå®¹å™¨
$ exit
```

è¿è¡Œå‘½ä»¤ä¸­æ˜ å°„çš„é…ç½®æ–‡ä»¶å‚è€ƒä¸‹è¾¹çš„é…ç½®æ–‡ä»¶è¯´æ˜ã€‚

#### 3.é…ç½®è¯´æ˜

æ¨¡æ¿ï¼š

```json
{
  "gpt_api_key": "ä½ çš„gpt api key",
  "auto_pass": true,
  "session_timeout": 60,
  "max_tokens": 1024,
  "model": "text-davinci-003",
  "temperature": 1,
  "reply_prefix": "æ¥è‡ªæœºå™¨äººå›å¤ï¼š",
  "session_clear_token": "æˆ‘è¦é—®ä¸‹ä¸€ä¸ªé—®é¢˜äº†",

  "dreamstdio_api_key":"ä½ çš„dreamstdioè´¦å·api_key",
  "engine_id":"stable-diffusion-v1-5",
  "picture_width":512,
  "picture_height":512,
  "steps":30,
  "cfg_scale":7,
  "picture_token":"ç”Ÿæˆå›¾ç‰‡"
}
```

å‚æ•°è¯´æ˜ï¼š

```
"gpt_api_key":						# openaiè´¦å·é‡Œè®¾ç½®çš„api_key
"auto_pass":# æ˜¯å¦è‡ªåŠ¨é€šè¿‡å¥½å‹æ·»åŠ 
  "session_timeout": 60,            # ä¼šè¯è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤60ç§’ï¼Œå•ä½ç§’ï¼Œåœ¨ä¼šè¯æ—¶é—´å†…æ‰€æœ‰å‘é€ç»™æœºå™¨äººçš„ä¿¡æ¯ä¼šä½œä¸ºä¸Šä¸‹æ–‡
  "max_tokens": 1024,               # GPTå“åº”å­—ç¬¦æ•°ï¼Œæœ€å¤§2048ï¼Œé»˜è®¤å€¼512ã€‚ä¼šå½±å“æ¥å£å“åº”é€Ÿåº¦ï¼Œå­—ç¬¦è¶Šå¤§å“åº”è¶Šæ…¢
  "model": "text-davinci-003",      # GPTé€‰ç”¨æ¨¡å‹ï¼Œé»˜è®¤text-davinci-003ï¼Œå…·ä½“é€‰é¡¹å‚è€ƒå®˜ç½‘è®­ç»ƒåœº
  "temperature": 1,                 # GPTçƒ­åº¦ï¼Œ0åˆ°1ï¼Œé»˜è®¤0.9ï¼Œæ•°å­—è¶Šå¤§åˆ›é€ åŠ›è¶Šå¼ºï¼Œä½†æ›´åç¦»è®­ç»ƒäº‹å®ï¼Œè¶Šä½è¶Šæ¥è¿‘è®­ç»ƒäº‹å®
  "reply_prefix": "æ¥è‡ªæœºå™¨äººå›å¤ï¼š", # ç§èŠå›å¤å‰ç¼€
  "session_clear_token": "æ¸…ç©ºä¼šè¯"  # ä¼šè¯æ¸…ç©ºå£ä»¤ï¼Œé»˜è®¤`ä¸‹ä¸ªé—®é¢˜`
  "dreamstdio_api_key":"ä½ çš„dreamstdioè´¦å·api_key",     #dreamstdioè´¦å·çš„api_key
  "engine_id":"stable-diffusion-v1-5",     			  #dreamstdioæ¨¡å‹çš„åç§°
  "picture_width":512,								  #ç”Ÿæˆå›¾ç‰‡çš„å®½åº¦ï¼Œé•¿åº¦ï¼Œé»˜è®¤512*512
  "picture_height":512,								#è¦æ±‚ä¸º64çš„å€æ•°ï¼Œä¸”>=128,å°ºå¯¸è¶Šå¤§æ¶ˆè€—çš„creditsè¶Šå¤š
  "steps":30,										#ä»£è¡¨æ¨¡å‹çš„æ¸²æŸ“æ­¥æ•°ï¼Œè¶Šé«˜å›¾ç‰‡è¶Šç²¾ç»†ï¼Œæ‰€éœ€çš„æ¸²æŸ“æ—¶é—´ä¹Ÿè¶Šé•¿ï¼Œé»˜è®¤ä¸º30ï¼Œæ•°å€¼è¶Šå¤§æ¶ˆè€—çš„creditsè¶Šå¤šï¼›
  "cfg_scale":7,									#è¡¨ç¤ºç”Ÿæˆå›¾åƒä¸æ–‡æœ¬æç¤ºçš„ç›¸ä¼¼åº¦ï¼Œè¶Šé«˜è¶Šåƒ
  "picture_token":"ç”Ÿæˆå›¾ç‰‡"						  #ç”Ÿæˆå›¾åƒçš„è§¦å‘å£ä»¤
```

## æºç è¿è¡Œ

é€‚åˆäº†è§£goè¯­è¨€ç¼–ç¨‹å¹¶æƒ³è¿›è¡Œæºç ä¿®æ”¹çš„åŒå­¦ï¼Œ

````shell
# è·å–é¡¹ç›®
$ git clone https://github.com/yinqishuo/chatgpt-dreamstudio_wechat_robot

# è¿›å…¥é¡¹ç›®ç›®å½•
$ cd chatgpt_wechat_robot

# å¤åˆ¶é…ç½®æ–‡ä»¶
$ cp config.dev.json config.json

# æ·»åŠ ä¾èµ–
$ go mod tidy

# å¯åŠ¨é¡¹ç›®
$ go run main.go

# è‹¥æƒ³ç¼–è¯‘ä¸ºå¯æ‰§è¡Œæ–‡ä»¶
$ go run main.go

# è‹¥æƒ³æ‰“åŒ…æˆdockeré•œåƒï¼Œéœ€å®‰è£…Docker ï¼Œå»ºè®®åœ¨linuxç¯å¢ƒä¸‹æ‰“åŒ…ï¼Œé•œåƒåç§°ä¸ºwechatbot
$ make docker

# æ‰§è¡Œé•œåƒï¼Œæ­¥éª¤å¦‚ä¸Š
````

### å¸¸è§é—®é¢˜

> å¦‚æ— æ³•ç™»å½•`login error: write storage.json: bad file descriptor`
> åˆ é™¤æ‰storage.jsonæ–‡ä»¶é‡æ–°ç™»å½•ã€‚

> å¦‚æ— æ³•ç™»å½•`login error: wechat network error: Get "https://wx.qq.com/cgi-bin/mmwebwx-bin/webwxnewloginpage": 301 response missing Location header`
> ä¸€èˆ¬æ˜¯å¾®ä¿¡ç™»å½•æƒé™é—®é¢˜ï¼Œå…ˆç¡®ä¿PCç«¯èƒ½å¦æ­£å¸¸ç™»å½•ã€‚

> å…¶ä»–æ— æ³•ç™»å½•é—®é¢˜
> å°è¯•åˆ é™¤æ‰storage.jsonæ–‡ä»¶ï¼Œç»“æŸè¿›ç¨‹(linuxä¸€èˆ¬æ˜¯kill -9 è¿›ç¨‹id)ä¹‹åé‡å¯ç¨‹åºï¼Œé‡æ–°æ‰«ç ç™»å½•ã€‚
> å¦‚æœä¸ºdocketéƒ¨ç½²ï¼ŒSupervisordè¿›ç¨‹ç®¡ç†å·¥å…·ä¼šè‡ªåŠ¨é‡å¯ç¨‹åºã€‚

> æœºå™¨äººä¸€ç›´ç­”éæ‰€é—®
> å¯èƒ½å› ä¸ºä¸Šä¸‹æ–‡ç´¯ç§¯è¿‡å¤šã€‚åˆ‡æ¢ä¸åŒé—®é¢˜æ—¶ï¼Œå‘é€æŒ‡ä»¤ï¼šå¯åŠ¨æ—¶é…ç½®çš„`session_clear_token`å­—æ®µã€‚ä¼šæ¸…ç©ºä¸Šä¸‹æ–‡

https://link.zhihu.com/?target=https%3A//github.com/Maks-s/sd-akashic

### å›¾åƒç”ŸæˆæŠ€å·§

æƒ³è®© AI å›¾åƒç”Ÿæˆå™¨åˆ›ä½œå‡ºç²¾å‡†é«˜è´¨çš„å›¾åƒï¼Œå¡«å†™å‡†ç¡®åˆé€‚çš„æ–‡æœ¬æç¤ºè¯ååˆ†é‡è¦ã€‚

1. ä¸è¦åªè¾“å…¥ä¸€ä¸ªç®€å•çš„è¯è¯­ï¼ˆraw promptï¼‰ï¼Œå¦‚ Pandaï¼ˆç†ŠçŒ«ï¼‰ã€A warriorï¼ˆæˆ˜å£«ï¼‰ç­‰ï¼Œè¿™æ ·ç”Ÿæˆçš„å›¾åƒä¼šç¼ºå°‘ç¾æ„Ÿå’Œè‰ºæœ¯æ€§ã€‚
2. ä½¿ç”¨é£æ ¼æç¤ºè¯èƒ½è®©å›¾åƒæ›´å…·è‰ºæœ¯æ€§ã€‚åœ¨æç¤ºè¯ä¸­åŠ å…¥è‰ºæœ¯é£æ ¼çš„å…³é”®è¯ï¼Œå¦‚ Realisticï¼ˆå†™å®ï¼‰ã€Oil paintingï¼ˆæ²¹ç”»ï¼‰ã€Pencil drawingï¼ˆé“…ç¬”ç”»ï¼‰ã€Concept artï¼ˆæ¦‚å¿µè‰ºæœ¯ï¼‰ç­‰ï¼›æ­¤å¤–å†™å®é£æ ¼çš„æç¤ºè¯æœ‰å¤šé‡è¡¨è¾¾å½¢å¼ï¼Œå¦‚[ a photo of + raw prompt ]ã€[ a photograph of + raw prompt ]ã€[ raw prompt,hyperrealistic ]ã€[ raw prompt,realistic ]ã€‚
3. ä½¿ç”¨è‰ºæœ¯å®¶åç§°è®©é£æ ¼æ›´å…·åƒæˆ–ä¿æŒé£æ ¼ä¸€è‡´ã€‚æ¯”å¦‚æƒ³è¡¨ç°æŠ½è±¡è‰ºæœ¯ï¼Œå¯ä»¥ä½¿ç”¨[made by Pablo Picassoa]æˆ–è€… [ raw prompt,Picassoa]ã€‚è¿˜å¯ä»¥åŒæ—¶è¾“å…¥å¤šåè‰ºæœ¯å®¶ï¼Œæ•ˆæœä¼šæ›´åŠ æœ‰è¶£ã€‚
4. æœ€ç»ˆä¿®é¥°è¯ã€‚åœ¨æ–‡æœ¬æœ«å°¾åŠ ä¸Šçš„ä¸€ä¸ªä¿®é¥°è¯ï¼Œä½¿å›¾åƒæ›´ç¬¦åˆä½ æƒ³è¦çš„æ•ˆæœã€‚æ¯”å¦‚æƒ³è¦é€¼çœŸçš„ç¯å…‰ï¼Œå¯ä»¥åŠ ä¸Šâ€œUnreal Engineâ€ï¼Œå±•ç°ç²¾å¯†ç»†èŠ‚åŠ ä¸Šâ€œ4Kâ€æˆ–â€œ8Kâ€ï¼Œæƒ³è¦æ›´æœ‰è‰ºæœ¯æ€§å¯ä»¥åŠ ä¸Šâ€œtrending on artstationâ€ç­‰ã€‚

**â‘  Stable Diffusion Artist Studies**

ç½‘å€ï¼š [https://proximacentaurib.notion.site/e2537cbf42c34b7e9a9a4126f81dfd0d](https://link.zhihu.com/?target=https%3A//proximacentaurib.notion.site/e2537cbf42c34b7e9a9a4126f81dfd0d)

ä¸€ä¸ªç”±å›½å¤–ç½‘å‹æ”¶é›†å»ºç«‹çš„è‰ºæœ¯å®¶é£æ ¼æ¦‚è§ˆè¡¨ï¼Œæ‰¾åˆ°ä½ å–œæ¬¢çš„é£æ ¼ååœ¨è‡ªå·±çš„æç¤ºè¯ä¸­åŠ ä¸Šå¯¹åº”è‰ºæœ¯å®¶çš„åå­—ï¼Œå°±èƒ½ç”Ÿæˆç±»ä¼¼é£æ ¼çš„å›¾ç‰‡ã€‚

**â‘¡ Stable Diffusion prompting cheatsheet**

ç½‘å€ï¼š [https://moritz.pm/posts/parameters](https://link.zhihu.com/?target=https%3A//moritz.pm/posts/parameters)

ä¸€ä¸ªç®€çŸ­çš„æç¤ºè¯åˆ—è¡¨ï¼Œé‡Œé¢åˆ—ä¸¾äº†å¦‚æœä½ æƒ³è¦å®ç° 3Dã€ç²¾è‡´ç»†èŠ‚ã€å…‰ç…§ã€å¤§ç¯å¢ƒç­‰æ•ˆæœï¼Œåº”è¯¥ä½¿ç”¨å“ªäº›å…³é”®è¯ã€‚

**â‘¢ Stable Diffusion Akashic Records**

ç½‘å€ï¼š [https://github.com/Maks-s/sd-akashic](https://link.zhihu.com/?target=https%3A//github.com/Maks-s/sd-akashic)

ä¸€ä¸ªä¸“ä¸šçš„ç ”ç©¶èµ„æ–™åº“ï¼Œæ”¶é›†äº†å…³äºæ¨¡å‹åŸç†ã€è‰ºæœ¯é£æ ¼ã€æç¤ºè¯ã€ä½¿ç”¨æŠ€å·§å’Œå…¶ä»–æœ‰ç”¨çš„å·¥å…·ï¼Œé€‚åˆæƒ³æ·±å…¥äº†è§£æ–‡æœ¬-å›¾åƒæ‰©æ•£æ¨¡å‹çš„äººé˜…è¯»ã€‚

> æœ¬æ®µå†…å®¹å¤åˆ¶äº[AIç»˜ç”»ç¥å™¨ï¼šDreamStudio - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/557665226)



### å‹æƒ…æç¤º

æœ¬é¡¹ç›®æ˜¯ fork ä»–äººçš„é¡¹ç›®æ¥è¿›è¡Œå­¦ä¹ å’Œä½¿ç”¨ï¼Œè¯·å‹¿å•†ç”¨ï¼Œå¯ä»¥ä¸‹è½½ä¸‹æ¥åšè‡ªå®šä¹‰çš„åŠŸèƒ½ã€‚
é¡¹ç›®åŸºäº[eatmoreapple](https://github.com/eatmoreapple)/**[openwechat](https://github.com/eatmoreapple/openwechat)** ã€[ZYallers](https://github.com/ZYallers)/**[chatgpt_wechat_robot](https://github.com/ZYallers/chatgpt_wechat_robot)** ã€[qingconglaixueit](https://github.com/qingconglaixueit)/**[wechatbot](https://github.com/qingconglaixueit/wechatbot)**å¼€å‘ã€‚